pipeline {
  agent any
  stages {
    stage('Checkout') {
      steps { git 'https://github.com/yourname/banking-app.git' }
    }
    stage('Build & Test') {
      steps { sh 'docker build -t banking-app .' }
    }
    stage('SonarQube Scan') { steps { sh 'echo "Scan code"' } }
    stage('Push to ECR') {
      steps {
        sh '''
        aws ecr get-login-password | docker login --username AWS --password-stdin <ECR_URL>
        docker tag banking-app:latest <ECR_URL>/banking-app:1.0
        docker push <ECR_URL>/banking-app:1.0
        '''
      }
    }
    stage('Update GitOps Repo') {
      steps { sh 'git add . && git commit -m "Update image" && git push' }
    }
  }
}
